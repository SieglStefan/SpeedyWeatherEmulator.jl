<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Functions &amp; Types index · SpeedyWeatherEmulator.jl</title><meta name="title" content="Functions &amp; Types index · SpeedyWeatherEmulator.jl"/><meta property="og:title" content="Functions &amp; Types index · SpeedyWeatherEmulator.jl"/><meta property="twitter:title" content="Functions &amp; Types index · SpeedyWeatherEmulator.jl"/><meta name="description" content="Documentation for SpeedyWeatherEmulator.jl."/><meta property="og:description" content="Documentation for SpeedyWeatherEmulator.jl."/><meta property="twitter:description" content="Documentation for SpeedyWeatherEmulator.jl."/><meta property="og:url" content="https://SieglStefan.github.io/SpeedyWeatherEmulator.jl/functions_index/"/><meta property="twitter:url" content="https://SieglStefan.github.io/SpeedyWeatherEmulator.jl/functions_index/"/><link rel="canonical" href="https://SieglStefan.github.io/SpeedyWeatherEmulator.jl/functions_index/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../home/">SpeedyWeatherEmulator.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../home/">Home</a></li><li><a class="tocitem" href="../running_SWE/">Running SpeedyWeatherEmulator.jl</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li class="is-active"><a class="tocitem" href>Functions &amp; Types index</a><ul class="internal"><li><a class="tocitem" href="#Core"><span>Core</span></a></li><li><a class="tocitem" href="#IO"><span>IO</span></a></li><li><a class="tocitem" href="#Data"><span>Data</span></a></li><li><a class="tocitem" href="#Emulator"><span>Emulator</span></a></li><li><a class="tocitem" href="#Evaluation"><span>Evaluation</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Functions &amp; Types index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Functions &amp; Types index</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/main/docs/src/functions_index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Functions-and-Types-index"><a class="docs-heading-anchor" href="#Functions-and-Types-index">Functions &amp; Types index</a><a id="Functions-and-Types-index-1"></a><a class="docs-heading-anchor-permalink" href="#Functions-and-Types-index" title="Permalink"></a></h1><h2 id="Core"><a class="docs-heading-anchor" href="#Core">Core</a><a id="Core-1"></a><a class="docs-heading-anchor-permalink" href="#Core" title="Permalink"></a></h2><p>Defines the fundamental data structure (<code>SimPara</code>) describing  how simulation data is parameterized. Further it contains helpful utility functions (<code>calc_n_coeff</code>, <code>is_coeff_zero</code>).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.SimPara" href="#SpeedyWeatherEmulator.SimPara"><code>SpeedyWeatherEmulator.SimPara</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SimPara</code></pre><p>Container for core simulation parameters that define SpeedyWeather.jl data generation,      resulting data shape and storage name.</p><p><strong>Fields</strong></p><ul><li><code>trunc::Int</code>: Spectral truncation of the barotropic model (e.g. 5 for T5).</li><li><code>n_data::Int</code>: Number of stored data time steps after spin-up.</li><li><code>n_ic::Int</code>: Number of simulated initial conditions (independent runs).</li><li><code>n_spinup::Int</code>: Number of spin-up steps discarded before sampling.</li><li><code>t_step::Real</code>: Physical time step length.</li><li><code>initial_cond::Union{Nothing, Function}</code>: Optional generator for initial conditions; <code>if nothing</code>, random ICs are used.</li><li><code>id_key::String</code>: Additional identifier to disambiguate saved datasets with identical <code>trunc</code>, <code>n_data</code> and <code>n_ic</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/core/basic_structs.jl#L2-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.SimPara-Tuple{}" href="#SpeedyWeatherEmulator.SimPara-Tuple{}"><code>SpeedyWeatherEmulator.SimPara</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SimPara(; trunc::Int,
         n_data::Int,
         n_ic::Int,
         n_spinup::Int = 9,
         t_step::Real = 1.0,
         initial_cond::Union{Nothing, Function} = nothing,
         id_key::String = &quot;&quot;)</code></pre><p>Convenience constructor for <code>SimPara</code>.</p><p><strong>Arguments</strong></p><ul><li><code>trunc::Int</code>: Spectral truncation of the barotropic model (e.g. 5 for T5).</li><li><code>n_data::Int</code>: Number of stored data time steps after spin-up.</li><li><code>n_ic::Int</code>: Number of simulated initial conditions (independent runs).</li><li><code>n_spinup::Int = 9</code>: Number of spin-up steps discarded before sampling (Default data sampling begins at t=10h).</li><li><code>t_step::Real = 1.0</code>: Physical time step length.</li><li><code>initial_cond::Union{Nothing, Function}</code>: Optional generator for initial conditions; <code>if nothing</code>, random ICs are used.</li><li><code>id_key::String = &quot;&quot;</code>: Additional identifier to disambiguate saved datasets with identical (<code>trunc</code>, <code>n_data</code>, <code>n_ic</code>).</li></ul><p><strong>Returns</strong></p><ul><li><code>::SimPara</code>: Container for simulation parameters that define the simulation and data storage.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sim_para = SimPara(trunc=5, n_data=50, n_ic=200, id_key=&quot;test-suite&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/core/basic_structs.jl#L28-L55">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.calc_n_coeff-Tuple{}" href="#SpeedyWeatherEmulator.calc_n_coeff-Tuple{}"><code>SpeedyWeatherEmulator.calc_n_coeff</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calc_n_coeff(; trunc::Int64)</code></pre><p>Calculate the number of complex spectral coefficients for a given spectral truncation.</p><p><strong>Arguments</strong></p><ul><li><code>trunc::Int64</code>: Spectral truncation of the barotropic model (e.g. 5 for T5).</li></ul><p><strong>Returns</strong></p><ul><li><code>n_coeff::Int64</code>: Number of complex spectral coefficients (without splitting into real/imag parts).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/core/utils.jl#L21-L31">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.is_coeff_zero-Tuple{Int64, Array{Float32, 3}}" href="#SpeedyWeatherEmulator.is_coeff_zero-Tuple{Int64, Array{Float32, 3}}"><code>SpeedyWeatherEmulator.is_coeff_zero</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">is_coeff_zero(i::Int64, data::Array{Float32, 3})</code></pre><p>Checks if a specific spectral coefficient - indexed <code>i</code> - is always zero in the simulation data <code>sim_data</code>.</p><p><strong>Arguments</strong></p><ul><li><code>i::Int64</code>: Index of spectral coefficient.</li><li><code>data::Array{Float32, 3}</code>: Spectral coefficients which are checked.</li></ul><p><strong>Returns</strong></p><ul><li><code>is_zero::Bool</code>: Returns if they are all zero.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/core/utils.jl#L2-L13">source</a></section></article><h2 id="IO"><a class="docs-heading-anchor" href="#IO">IO</a><a id="IO-1"></a><a class="docs-heading-anchor-permalink" href="#IO" title="Permalink"></a></h2><p>Provides functions for handling data. Including creating data paths (<code>data_path</code>), deleting data (<code>delete_data</code>), and saving/loading data (<code>save_data</code>, <code>load_data</code>) for specific types.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.data_path-Tuple{SimPara}" href="#SpeedyWeatherEmulator.data_path-Tuple{SimPara}"><code>SpeedyWeatherEmulator.data_path</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">data_path(sim_para::SimPara; type::String)</code></pre><p>Creates the folder or file path for storing data associated with <code>sim_para</code>.</p><p><strong>Arguments</strong></p><ul><li><code>sim_para::SimPara</code>: Simulation parameters (used to build unique name).</li><li><code>type::String</code>: Data type; <code>&quot;raw_data&quot;</code>, <code>&quot;sim_data&quot;</code>, <code>&quot;emulator&quot;</code> or <code>&quot;losses&quot;</code>.</li><li><code>path::String = &quot;&quot;</code>: Optional absolute path for data storage.     If left empty, the function defaults to the package&#39;s internal <code>data/&lt;type&gt;</code> folder.  </li></ul><p><strong>Returns</strong></p><ul><li><code>::String</code>: Absolute normalized path to the storage location.</li></ul><p><strong>Naming Convention</strong></p><ul><li>For raw data: <code>/data/raw_data/T&lt;trunc&gt;_ndata&lt;n_data&gt;_IC&lt;n_ic&gt;_ID&lt;id_key&gt;/</code></li><li>For all other types: <code>/data/&lt;type&gt;/&lt;type&gt;_T&lt;trunc&gt;_ndata&lt;n_data&gt;_IC&lt;n_ic&gt;_ID&lt;id_key&gt;.jld2</code></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sim_para = SimPara(trunc=5, n_data=50, n_ic=200, id_key=&quot;demo&quot;)
data_path(sim_para; type=&quot;sim_data&quot;)
# → &quot;.../data/sim_data/sim_data_T5_ndata50_IC200_IDdemo.jld2&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/io/utils_io.jl#L4-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.delete_data-Tuple{SimPara}" href="#SpeedyWeatherEmulator.delete_data-Tuple{SimPara}"><code>SpeedyWeatherEmulator.delete_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">delete_data(sim_para::SimPara; type::String, overwrite::Bool=false)</code></pre><p>Delete existing data of <code>type</code> <code>&quot;raw_data&quot;</code>, <code>&quot;sim_data&quot;</code>, <code>&quot;emulator&quot;</code> or <code>&quot;losses&quot;</code></p><p><strong>Description</strong></p><ul><li>Checks whether the path already exists.</li><li>If <code>overwrite=true</code>: deletes existing content and creates a new folder if <code>type = &quot;raw_data&quot;</code>.</li><li>If <code>overwrite=false</code>: keeps existing data untouched and sets <code>cancel_sim=true</code> to cancel current process.</li></ul><p><strong>Arguments</strong></p><ul><li><code>sim_para::SimPara</code>: Simulation parameters (used for identifying data).</li><li><code>type::String</code>: Data type; <code>&quot;raw_data&quot;</code>, <code>&quot;sim_data&quot;</code>, <code>&quot;emulator&quot;</code>, <code>&quot;losses&quot;</code>.</li><li><code>overwrite::Bool = false</code>: Control overwrite behavior.</li><li><code>path::String = &quot;&quot;</code>: Optional absolute path for data storage.     If left empty, the function defaults to the package&#39;s internal <code>data/&lt;type&gt;</code> folder.  </li></ul><p><strong>Returns</strong></p><ul><li><code>path::String</code>: Target folder/file path.</li><li><code>cancel_sim::Bool</code>: True if the current process must be stopped because data is not allowed to be overwritten.</li></ul><p><strong>Notes</strong></p><ul><li>For <code>&quot;raw_data&quot;</code>, creates a directory tree.</li><li>For other types, returns the target <code>.jld2</code> path (no folder created).</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sim_para = SimPara(trunc=5, n_data=50, n_ic=200, id_key=&quot;test&quot;)
delete_data(sim_para; type=&quot;sim_data&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/io/utils_io.jl#L53-L83">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.load_data-Tuple{SimPara}" href="#SpeedyWeatherEmulator.load_data-Tuple{SimPara}"><code>SpeedyWeatherEmulator.load_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">load_data(sim_para::SimPara; type::String)</code></pre><p>Load previously saved data of a given type using the defining simulation parameters.</p><p><strong>Arguments</strong></p><ul><li><code>sim_para::SimPara</code>: Simulation parameters; determines the folder/file name.</li><li><code>type::String</code>: Dataset type, e.g. <code>&quot;sim_data&quot;</code>, <code>&quot;emulator&quot;</code>, <code>&quot;losses&quot;</code>.</li><li><code>path::String = &quot;&quot;</code>: Optional absolute path for data loading.   If left empty, the function defaults to the package&#39;s internal <code>data/&lt;type&gt;</code> folder.  </li></ul><p><strong>Returns</strong></p><ul><li><code>::Union{SimData, Emulator, Losses}</code>: The saved object stored in the JLD2 file under the key <code>&quot;data&quot;</code>.   (For example a <code>SimData</code>, <code>Emulator</code>, or <code>Losses</code> object.)</li></ul><p><strong>Notes</strong></p><ul><li><code>load_data</code> is intended for JLD2-based single-file storage types.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sim_para = SimPara(trunc=5, n_data=50, n_ic=200)
sim_data_loaded = load_data(sim_para; type=&quot;sim_data&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/io/io.jl#L68-L91">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.save_data-Tuple{Union{Emulator, Losses, SimData}}" href="#SpeedyWeatherEmulator.save_data-Tuple{Union{Emulator, Losses, SimData}}"><code>SpeedyWeatherEmulator.save_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">save_data(data::Union{SimData, Emulator, Losses}; overwrite::Bool=false)</code></pre><p>Save simulation- or training-related data (<code>SimData</code>, <code>Emulator</code>, <code>Losses</code>) using JLD2.</p><p><strong>Description</strong></p><ul><li>Builds a consistent file/folder path from the associated <code>SimPara</code> via <code>data_path</code> for saving <code>data</code>.</li><li>Prevents overwriting unless <code>overwrite=true</code>.</li><li>Uses JLD2 to serialize the given <code>data</code>.</li></ul><p><strong>Arguments</strong></p><ul><li><code>data::Union{SimData, Emulator, Losses}</code>: The container to save.   Must have a field <code>sim_para::SimPara</code>.</li><li><code>overwrite::Bool = false</code>: If true, existing file/folder is deleted before writing.</li><li><code>path::String = &quot;&quot;</code>: Optional absolute path for data saving.   If left empty, the function defaults to the package&#39;s internal <code>data/&lt;type&gt;</code> folder.  </li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: Data is written to the file system.</li></ul><p><strong>Notes</strong></p><ul><li>For <code>raw_data</code>: Creates a directory tree with subfolders <code>run_0001</code>, <code>run_0002</code>, ….</li><li>For all other types: Saves to a single <code>.jld2</code> file.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sim_para = SimPara(trunc=5, n_data=50, n_ic=200, id_key=&quot;demo&quot;)
sim_data = SimData(sim_para)
save_data(sim_data; type=&quot;sim_data&quot;, overwrite=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/io/io.jl#L5-L35">source</a></section></article><h2 id="Data"><a class="docs-heading-anchor" href="#Data">Data</a><a id="Data-1"></a><a class="docs-heading-anchor-permalink" href="#Data" title="Permalink"></a></h2><p>Handles data generation and preparation. This includes creating raw simulation data with SpeedyWeather.jl (<code>generate_raw_data</code>), wrapping it into structured containers (<code>SimData</code>), and formatting it into train/validation/test sets (<code>DataPairs</code>, <code>FormattedData</code>).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.generate_raw_data-Tuple{SimPara}" href="#SpeedyWeatherEmulator.generate_raw_data-Tuple{SimPara}"><code>SpeedyWeatherEmulator.generate_raw_data</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_raw_data(sim_para::SimPara; overwrite::Bool=false, path::String=&quot;&quot;)</code></pre><p>Generate raw vorticity data with SpeedyWeather.jl based on the given simulation parameters.</p><p><strong>Description</strong></p><ul><li>Prepares a raw-data folder using <code>prepare_folder</code>.</li><li>Runs the barotropic model with spectral truncation <code>sim_para.trunc</code> and time step <code>sim_para.t_step</code>.</li><li>For each initial condition (IC), creates a new run subfolder and stores the simulated vorticity.</li><li>If <code>overwrite=false</code> and data already exist, generation is canceled.</li></ul><p><strong>Arguments</strong></p><ul><li><code>sim_para::SimPara</code>: Container for parameters that define the simulation and data storage.</li><li><code>overwrite::Bool = false</code>: If true, delete existing data and regenerate.     If false, aborts safely when data already exist.</li><li><code>path::String = &quot;&quot;</code>: Optional absolute path for data storage.     If left empty, the function defaults to the package&#39;s internal <code>data/&lt;type&gt;</code> folder.</li></ul><p><strong>Returns</strong></p><ul><li><code>::Bool</code>: Returns a boolean value that indicates if the data was generated successfully.</li></ul><p><strong>Notes</strong></p><ul><li>Spin-up steps (<code>n_spinup</code>) are run but <strong>not stored</strong> in later <code>SimData</code>.</li><li>If <code>sim_para.initial_cond</code> is not <code>nothing</code>, this function applies the given IC via <code>set!(sim, vor=…)</code>.</li><li>Sometimes overwriting <code>raw_data</code> files is not possible because the folders are open/busy.   Data Generation is then canceled.</li><li>Only prognostic variables are stored.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sim_para = SimPara(trunc=5, n_data=50, n_ic=200, id_key=&quot;123&quot;)
generate_raw_data(sim_para; overwrite=true)
# → creates data/raw_data/raw_data_T5_ndata50_IC200_ID123/run_0001/output.jld2, ..., run_0200/output.jld2</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/data/generate_raw_data.jl#L4-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.SimData" href="#SpeedyWeatherEmulator.SimData"><code>SpeedyWeatherEmulator.SimData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SimData(sim_para::SimPara, path::String=&quot;&quot;)</code></pre><p>Construct a <code>SimData</code> container by <strong>loading previously generated raw data</strong> and extracting the spectral vorticity coefficients time series into a consistent tensor layout.</p><p>This constructor:</p><ol><li>infers <code>(n_coeff, n_data, n_ic)</code> from <code>sim_para</code>,</li><li>allocates the target array <code>data::Array{Float32,3}</code> with shape (2 * <code>n_coeff</code>, <code>n_data</code>, <code>n_ic</code>),</li><li>iterates over runs <code>ic = 1:n_ic</code>, loads <code>output.jld2</code>, and reads <code>output_vector</code>,</li><li>for each stored step <code>step ∈ {n_spinup+1, …, n_spinup + n_data}</code>:<ul><li>extracts the spectral vorticity <code>vor</code>,</li><li>writes <code>real(vor)</code> to rows <code>1:n_coeff</code> and <code>imag(vor)</code> to rows <code>n_coeff+1:2n_coeff</code>,</li><li>stores at time index <code>step + 1 - n_spinup</code>.</li></ul></li></ol><p><strong>Arguments</strong></p><ul><li><code>sim_para::SimPara</code>: Container for parameters that define the simulation and data storage;    <strong>must match</strong> the generated raw data on disk.</li><li><code>path::String = &quot;&quot;</code>: Optional absolute path of storaged <code>raw_data</code>.     If left empty, the function defaults to the package&#39;s internal <code>data/&lt;type&gt;</code> folder.</li></ul><p><strong>Returns</strong></p><ul><li><code>::SimData</code>: Container holding simulation data and corresponding sim. parameters.</li></ul><p><strong>Preconditions</strong></p><ul><li>Expects raw data in <code>data_path(sim_para; type=&quot;raw_data&quot;)</code> with per-run subfolders   <code>run_0001</code>, <code>run_0002</code>, … each containing <code>output.jld2</code> with an <code>output_vector</code>.</li><li>Raw data should be created beforehand via <code>generate_raw_data(sim_para; overwrite=false)</code>.</li></ul><p><strong>Notes</strong></p><ul><li>The leading factor <code>2</code> in the first dimension stacks real and imaginary parts.</li><li>The time indexing uses <code>step - n_spinup</code> to map stored steps to <code>1:n_data</code>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">sim_para = SimPara(trunc=5, n_data=50, n_ic=200)
# after generate_raw_data(sim_para) has been called:
sim_data = SimData(sim_para)
# inspect shapes
size(sim_data.data)  # (2*n_coeff, n_data, n_ic)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/data/build_sim_data.jl#L26-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.SimData" href="#SpeedyWeatherEmulator.SimData"><code>SpeedyWeatherEmulator.SimData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SimData</code></pre><p>Container for SpeedyWeather.jl vorticity data together with the simulation parameters.</p><p><strong>Fields</strong></p><ul><li><code>sim_para::SimPara</code>: Container for parameters that define the simulation and data storage.</li><li><code>data::Array{Float32,3}</code>: Vorticity tensor with shape (2 * <code>n_coeff</code>, <code>n_data</code>, <code>n_ic</code>)       where <code>n_coeff = calc_n_coeff(sim_para.trunc)</code>.        The first <code>n_coeff</code> rows store the <strong>real</strong> parts,        the next <code>n_coeff</code> rows the <strong>imaginary</strong> parts of the complex spectral coefficients.</li></ul><p><strong>Notes</strong></p><ul><li>The layout is column-major and optimized for contiguous slicing over time and ICs.</li><li>Dimensions are inferred from <code>sim_para</code> and remain consistent across the pipeline.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/data/build_sim_data.jl#L4-L19">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.DataPairs" href="#SpeedyWeatherEmulator.DataPairs"><code>SpeedyWeatherEmulator.DataPairs</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DataPairs(x_train, y_train, x_valid, y_valid, x_test, y_test)</code></pre><p>Container for paired data samples (x,y) = (vor(t), vor(t+Δt)), already split into training, validation and test sets.</p><p><strong>Fields</strong></p><ul><li><code>x_train::Matrix{Float32}</code>: Training inputs vor(t).</li><li><code>y_train::Matrix{Float32}</code>: Training targets vor(t+Δt).</li><li><code>x_valid::Matrix{Float32}</code>: Validation inputs vor(t).</li><li><code>y_valid::Matrix{Float32}</code>: Validation targets vor(t+Δt).</li><li><code>x_test::Matrix{Float32}</code>: Test inputs vor(t).</li><li><code>y_test::Matrix{Float32}</code>: Test targets vor(t+Δt).</li></ul><p><strong>Notes</strong></p><ul><li>All matrices have the same row dimension = 2 * n_coeff.</li><li>Columns index over independent time-pairs and ICs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/data/format_sim_data.jl#L3-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.FormattedData" href="#SpeedyWeatherEmulator.FormattedData"><code>SpeedyWeatherEmulator.FormattedData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FormattedData</code></pre><p>Container for formatted data, i.e. paired vorticity samples (x,y) = (vor(t), vor(t+Δt)).</p><p><strong>Fields</strong></p><ul><li><code>sim_para::SimPara</code>: Container for parameters that define the simulation and data storage.</li><li><code>data_pairs::DataPairs</code>: The split and paired data.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/data/format_sim_data.jl#L31-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.FormattedData-Tuple{SimData}" href="#SpeedyWeatherEmulator.FormattedData-Tuple{SimData}"><code>SpeedyWeatherEmulator.FormattedData</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FormattedData(sim_data::SimData; splits=(train=0.7, valid=0.15, test=0.15))</code></pre><p>Construct <code>FormattedData</code> directly from <code>SimData</code> by pairing consecutive time steps     and splitting them into train/validation/test sets.</p><p><strong>Description</strong></p><ul><li>Builds (x,y) pairs as<ul><li>x = vor(t) = spectral vorticity state at time t,</li><li>y = vor(t+Δt) at the next time step.</li></ul></li><li>Reshapes all ICs and times into column vectors.</li><li>Splits the resulting pairs according to the fractions in <code>splits</code>.</li></ul><p><strong>Arguments</strong></p><ul><li><code>sim_data::SimData</code>: Container holding simulation data and corresponding sim. parameters.</li><li><code>splits::NamedTuple</code>: Fractions for train-, valid- and test-set.     Default = (0.7, 0.15, 0.15).</li></ul><p><strong>Returns</strong></p><ul><li><code>::FormattedData</code>: Container holding formatted (paired) simulation data and corresponding sim. parametrs.</li></ul><p><strong>Notes</strong></p><ul><li>The number of total pairs is (<code>n_data</code> - 1) * `n_ic.</li><li>Splits are normalized so that train + valid + test = 1.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">fd = FormattedData(sim_data; splits=(train=0.7, valid=0.2, test=0.1))
size(fd.data_pairs.x_train)  # (2*n_coeff, n_train)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/data/format_sim_data.jl#L46-L76">source</a></section></article><h2 id="Emulator"><a class="docs-heading-anchor" href="#Emulator">Emulator</a><a id="Emulator-1"></a><a class="docs-heading-anchor-permalink" href="#Emulator" title="Permalink"></a></h2><p>Handles emulator definition, normalization, training, and evaluation. This includes Z-score normalization utilities (<code>ZscorePara</code>, <code>zscore</code>, <code>inv_zscore</code>), core emulator types (<code>NeuralNetwork</code>, <code>Emulator</code>, <code>Losses</code>), training workflow (<code>train_emulator</code>), and evaluation against SpeedyWeather.jl reference data (<code>compare_emulator</code>).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.ZscorePara" href="#SpeedyWeatherEmulator.ZscorePara"><code>SpeedyWeatherEmulator.ZscorePara</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ZscorePara(μ::Vector{Float32}, σ::Vector{Float32})</code></pre><p>Container for the parameters of a Z-score transformation.</p><p><strong>Fields</strong></p><ul><li><code>μ::Vector{Float32}</code>: Mean for each coefficient across samples.</li><li><code>σ::Vector{Float32}</code>: Std for each coefficient across samples</li></ul><p><strong>Notes</strong></p><ul><li>Typically computed from the <strong>training set only</strong> to avoid data leakage.</li><li>For each coefficient indexed i: z<em>i = (x</em>i - μ<em>i) / σ</em>i</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/zscore_trafo.jl#L4-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.inv_zscore-Tuple{Array{Float32}, ZscorePara}" href="#SpeedyWeatherEmulator.inv_zscore-Tuple{Array{Float32}, ZscorePara}"><code>SpeedyWeatherEmulator.inv_zscore</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">inv_zscore(x::Array{Float32}, stats::ZscorePara)</code></pre><p>Inverse Z-score transformation (restore original scale).</p><p><strong>Arguments</strong></p><ul><li><code>x::Array{Float32}</code>: Z-score normalized data.</li><li><code>stats::ZscorePara</code>: Parameters with mean μ and std σ.</li></ul><p><strong>Returns</strong></p><ul><li><code>::Array{Float32}</code>: Data rescaled back to the original distribution.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">stats = ZscorePara([0.0f0, 1.0f0], [1.0f0, 2.0f0])
z = Float32[0 -0.5; 1 0.5]
x = inv_zscore(z, stats)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/zscore_trafo.jl#L51-L69">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.zscore-Tuple{Array{Float32}, ZscorePara}" href="#SpeedyWeatherEmulator.zscore-Tuple{Array{Float32}, ZscorePara}"><code>SpeedyWeatherEmulator.zscore</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zscore(x, stats::ZscorePara)</code></pre><p>Apply a Z-score transformation to data <code>x</code> using the parameters in <code>stats</code>.</p><p><strong>Arguments</strong></p><ul><li><code>x::AbstractArray</code>: Input data (rows = coefficients, columns = samples).</li><li><code>stats::ZscorePara</code>: Parameters with mean μ and std σ.</li></ul><p><strong>Returns</strong></p><ul><li><code>::Array{Float32}</code>: Z-score normalized data.</li></ul><p><strong>Notes</strong></p><ul><li>Each coefficient is transformed independently.</li><li>A small <code>eps(Float32)</code> is added to σ to avoid division by zero.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">stats = ZscorePara([0.0f0, 1.0f0], [1.0f0, 2.0f0])
x = Float32[0 2; 1 3]
z = zscore(x, stats)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/zscore_trafo.jl#L23-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.Emulator" href="#SpeedyWeatherEmulator.Emulator"><code>SpeedyWeatherEmulator.Emulator</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Emulator</code></pre><p>Container for a trained (or in-progress) neural network emulator.</p><p><strong>Fields</strong></p><ul><li><code>sim_para::SimPara</code>: Simulation parameters of the dataset used for training, validation and testing.</li><li><code>chain::Flux.Chain</code>: Neural network architecture and weights.</li><li><code>zscore_para::ZscorePara</code>: Normalization parameters (mean/std of training set).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/emulator_structs.jl#L40-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.Emulator-Tuple{NeuralNetwork, ZscorePara, SimPara}" href="#SpeedyWeatherEmulator.Emulator-Tuple{NeuralNetwork, ZscorePara, SimPara}"><code>SpeedyWeatherEmulator.Emulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Emulator(nn::NeuralNetwork, zscore_para::ZscorePara, sim_para::SimPara)</code></pre><p>Constructor for an <code>Emulator</code>. Builds a feed-forward network with ReLU activations according to the given <code>NeuralNetwork</code> specs.</p><p><strong>Arguments</strong></p><ul><li><code>nn::NeuralNetwork</code>: Parameters of the architecture (layer sizes).</li><li><code>zscore_para::ZscorePara</code>: Normalization parameters of the training data.</li><li><code>sim_para::SimPara</code>: Simulation parameters used for generating the training data.</li></ul><p><strong>Returns</strong></p><ul><li><code>::Emulator</code>: A wrapped Flux model with normalization metadata.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/emulator_structs.jl#L57-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.Emulator-Tuple{VecOrMat{Float32}}" href="#SpeedyWeatherEmulator.Emulator-Tuple{VecOrMat{Float32}}"><code>SpeedyWeatherEmulator.Emulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">(m::Emulator)(x::Union{Vector{Float32}, Matrix{Float32}})</code></pre><p>Convenience call overload. Apply the trained emulator to spectral coefficients at time t to predict coefficients at t + Δt.</p><p><strong>Arguments</strong></p><ul><li><code>x::Vector{Float32}</code>: Spectral coefficients of vorticity at time t (size = 2 * n_coeff).</li><li><code>x::Matrix{Float32}</code>: Multiple states, each column a spectral coefficients vector at time t (size = (2 * n_coeff, N)).</li></ul><p><strong>Returns</strong></p><ul><li><code>::Vector{Float32}</code>: Emulator prediction for a single state at t + Δt (same size as input vector).</li><li><code>::Matrix{Float32}</code>: Emulator predictions for multiple states, one prediction per column (same shape as input matrix).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/emulator_structs.jl#L82-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.Losses" href="#SpeedyWeatherEmulator.Losses"><code>SpeedyWeatherEmulator.Losses</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Losses</code></pre><p>Container for logging training, validation, and test losses.</p><p><strong>Fields</strong></p><ul><li><code>sim_para::SimPara</code>: Simulation parameters of the dataset used.</li><li><code>train::Vector{Float32}</code>: Training loss per batch.</li><li><code>valid::Vector{Float32}</code>: Validation loss per batch.</li><li><code>test::Vector{Float32}</code>: Test loss per batch.</li><li><code>bpe_train::Int64</code>: Batches per epoch (training set).</li><li><code>bpe_valid::Int64</code>: Batches per epoch (validation set).</li><li><code>bpe_test::Int64</code>: Batches per epoch (test set).</li><li><code>training_time</code>: Time needed for training the model in seconds.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/emulator_structs.jl#L103-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.Losses-Tuple{SimPara, Int64, Int64}" href="#SpeedyWeatherEmulator.Losses-Tuple{SimPara, Int64, Int64}"><code>SpeedyWeatherEmulator.Losses</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Losses(sim_para::SimPara, bpe_train::Int64, bpe_valid::Int64)</code></pre><p>Constructor for an empty <code>Losses</code> container.</p><p><strong>Arguments</strong></p><ul><li><code>sim_para::SimPara</code>: Simulation parameters of the dataset used.</li><li><code>bpe_train::Int64</code>: Batches per epoch (training set).</li><li><code>bpe_valid::Int64</code>: Batches per epoch (validation set).</li></ul><p><strong>Returns</strong></p><ul><li><code>::Losses</code>: Initialized container with empty loss vectors and <code>bpe_test = 0</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/emulator_structs.jl#L130-L142">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.NeuralNetwork" href="#SpeedyWeatherEmulator.NeuralNetwork"><code>SpeedyWeatherEmulator.NeuralNetwork</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NeuralNetwork</code></pre><p>Container for the layer dimensions of a neural network.</p><p><strong>Fields</strong></p><ul><li><code>io_dim::Int64</code>: Dimension of the input and output layer (e.g. number of spectral coefficients).</li><li><code>hidden_dim::Int64</code>: Dimension of each hidden layer.</li><li><code>n_hidden::Int64</code>: Number of hidden layers.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/emulator_structs.jl#L5-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.NeuralNetwork-Tuple{}" href="#SpeedyWeatherEmulator.NeuralNetwork-Tuple{}"><code>SpeedyWeatherEmulator.NeuralNetwork</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NeuralNetwork(; io_dim::Int64=54, hidden_dim::Int64=128, n_hidden::Int64=1)</code></pre><p>Convenience constructor for <code>NeuralNetwork</code>.</p><p><strong>Arguments</strong></p><ul><li><code>io_dim::Int64</code>: Dimension of the input and output layer (e.g. number of spectral coefficients).</li><li><code>hidden_dim::Int64</code>: Dimension of each hidden layer.</li><li><code>n_hidden::Int64</code>: Number of hidden layers.</li></ul><p><strong>Returns</strong></p><ul><li><code>::NeuralNetwork</code>: Parameter container.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/emulator_structs.jl#L22-L34">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.compare_emulator-Tuple{Emulator}" href="#SpeedyWeatherEmulator.compare_emulator-Tuple{Emulator}"><code>SpeedyWeatherEmulator.compare_emulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">compare_emulator(em::Emulator; 
                 x_test::Matrix{Float32},
                 y_test::Matrix{Float32},
                 n_it::Int64=1,
                 output::Bool=false,
                 all_coeff::Bool=false)</code></pre><p>Compare emulator predictions against SpeedyWeather.jl reference data.</p><p><strong>Description</strong></p><ul><li>Applies the emulator <code>em</code> to test inputs <code>x_test</code> and compares results to <code>y_test</code> for <code>n_it</code> timesteps.</li><li>Computes mean relative error per spectral coefficient:    rel<em>err</em>i = |ŷ<em>i - y</em>i| / (|y_i| + ε) * 100.</li><li>Prints mean relative error (all coefficients averaged) and maximum mean relative error.</li><li>Optionally prints coefficient-wise relative errors.</li></ul><p><strong>Arguments</strong></p><ul><li><code>em::Emulator</code>: Trained emulator to evaluate.</li><li><code>x_test::Matrix{Float32}</code>: Test inputs (vorticity coefficients at t) of form (2 * n_coeff, N).</li><li><code>y_test::Matrix{Float32}</code>: Reference outputs from SpeedyWeather.jl (at t+n<em>it*Δt) of form (2 * n</em>coeff, N).</li><li><code>n_it::Int64</code>: Number of timesteps compared.</li><li><code>output::Bool=false</code>: If true, print errors to STDOUT.</li><li><code>all_coeff::Bool=false</code>: If true, print relative error for each coefficient.</li></ul><p><strong>Returns</strong></p><ul><li><code>mean_mean_rel::Float32</code>: The mean (all spectral coeff.) mean (all possible datapairs) relative error for <code>n_it</code> timesteps.</li></ul><p><strong>Notes</strong></p><ul><li>The larger <code>n_it</code>, the fewer data pairs are available for comparison. For example:   <code>n_data=4</code> and <code>n_it=2</code> leads to data pairs 1-2-3 and 2-3-4.</li><li>Some coefficients in SpeedyWeather.jl are structurally zero → flagged in output.</li><li>Errors are reported in percent [%].</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">emu, losses = train_emulator(nn, fd)
compare_emulator(emu; 
    x_test=fd.data_pairs.x_test,
    y_test=fd.data_pairs.y_test,
    all_coeff=true)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/compare_emulator.jl#L5-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.train_emulator-Tuple{NeuralNetwork, FormattedData}" href="#SpeedyWeatherEmulator.train_emulator-Tuple{NeuralNetwork, FormattedData}"><code>SpeedyWeatherEmulator.train_emulator</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">train_emulator(nn::NeuralNetwork, fd::FormattedData; sim_para::SimPara=fd.sim_para, 
               batchsize::Int=32, n_epochs::Int=300, η0::Real=0.001)</code></pre><p>Train an emulator (neural network) with the given architecture and data.</p><p><strong>Description</strong></p><ul><li>Computes Z-score parameters from the training set.</li><li>Constructs an <code>Emulator</code> with the given <code>NeuralNetwork</code>.</li><li>Applies Z-score normalization to training and validation pairs.</li><li>Trains the network using Adam with initial learning rate η0.</li><li>Halves the learning rate every 30 epochs.</li><li>Logs training and validation losses.</li><li>Calls <code>compare_emulator</code> on the test set after training.</li></ul><p><strong>Arguments</strong></p><ul><li><code>nn::NeuralNetwork</code>: Defines the structure (layer sizes) of the neural network.</li><li><code>fd::FormattedData</code>: Formatted dataset with train/valid/test splits of size (2*n_coeff, N).</li><li><code>sim_para::SimPara=fd.sim_para</code>: Optional different simulation parameters for better saving.</li><li><code>batchsize::Int=32</code>: Training batch size.</li><li><code>n_epochs::Int=300</code>: Number of training epochs.</li><li><code>η0::Real=0.001</code>: Initial learning rate.</li></ul><p><strong>Returns</strong></p><ul><li><code>em::Emulator</code>: Trained emulator model (Flux chain + normalization).</li><li><code>losses::Losses</code>: Recorded training/validation losses and batches per epoch.</li></ul><p><strong>Notes</strong></p><ul><li>Test set evaluation is not part of the training loop; only <code>compare_emulator</code> is called at the end.</li><li>Normalization statistics are always computed from the training set to avoid leakage.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">nn = NeuralNetwork(io_dim=54, hidden_dim=128, n_hidden=2)
fd = FormattedData(sim_data; splits=(train=0.7, valid=0.2, test=0.1))
em, losses = train_emulator(nn, fd; batchsize=64, n_epochs=100, η0=0.0005)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/emulator/train_emulator.jl#L7-L44">source</a></section></article><h2 id="Evaluation"><a class="docs-heading-anchor" href="#Evaluation">Evaluation</a><a id="Evaluation-1"></a><a class="docs-heading-anchor-permalink" href="#Evaluation" title="Permalink"></a></h2><p>Handles evaluation and visualization of emulator and simulation output. This includes plotting forecast stability for SpeedyWeather.jl runs (<code>plot_forecast_test</code>), plotting loss plots (<code>plot_losses</code>), and reconstructing vorticity fields from spectral coefficients as heatmaps (<code>plot_heatmap</code>).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.plot_losses-Tuple{Losses}" href="#SpeedyWeatherEmulator.plot_losses-Tuple{Losses}"><code>SpeedyWeatherEmulator.plot_losses</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_losses(losses::Losses)</code></pre><p>Plot training and validation losses stored in a <code>Losses</code> container.</p><p><strong>Description</strong></p><ul><li>Plots training loss per batch (log-log scale).</li><li>Adds epoch-averaged training and validation loss curves.</li><li>Returns a <code>Plots.Plot</code> object for further customization or saving.</li></ul><p><strong>Arguments</strong></p><ul><li><code>losses::Losses</code>: Container with training/validation loss history and number of batches per epoch.</li><li><code>title::String=&quot;Losses of the emulator&quot;</code>: Optional argument for different plot titles (e.g. differen simulation parameters).</li></ul><p><strong>Returns</strong></p><ul><li><code>p::Plots.Plot</code>: Combined plot of training and validation losses.</li></ul><p><strong>Notes</strong></p><ul><li>Training batches per epoch = <code>losses.bpe_train</code>.</li><li>Validation batches per epoch = <code>losses.bpe_valid</code>.</li><li>Number of epochs is inferred as <code>length(losses.train) / bpe_train</code>.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">emu, losses = train_emulator(nn, fd)
p = plot_losses(losses)
display(p)  </code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/evaluation/plot_losses.jl#L4-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.plot_heatmap-Tuple{Vector{Float32}}" href="#SpeedyWeatherEmulator.plot_heatmap-Tuple{Vector{Float32}}"><code>SpeedyWeatherEmulator.plot_heatmap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plot_heatmap(vec::Vector{Float32}; trunc::Int64, title::String=&quot;&quot;)</code></pre><p>Plot a heatmap of a vorticity field reconstructed from a spectral coefficient vector.</p><p><strong>Description</strong></p><ul><li>Converts spectral coefficients in vector form into a <code>LowerTriangularMatrix</code>.</li><li>Transforms this into a grid suitable for plotting.</li><li>Displays the grid as a heatmap using CairoMakie.</li></ul><p><strong>Arguments</strong></p><ul><li><code>vec::Vector{Float32}</code>: Spectral coefficient vector (real/imag stacked).</li><li><code>trunc::Int64</code>: Spectral truncation of the model (e.g. 5 for T5).</li><li><code>title::String=&quot;Vorticity Heatmap&quot;</code>: Optional argument for different plot titles (e.g. differen simulation parameters).</li></ul><p><strong>Returns</strong></p><ul><li><code>::CairoMakie.Plot</code>: Heatmap figure object.</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">vec = rand(Float32, 54)   # random spectral coeffs for trunc=5
fig = plot_heatmap(vec; trunc=5, title=&quot;Vorticity field&quot;)
display(fig)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/evaluation/plot_heatmap.jl#L5-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SpeedyWeatherEmulator.vec_to_ltm-Tuple{Vector{Float32}, Int64}" href="#SpeedyWeatherEmulator.vec_to_ltm-Tuple{Vector{Float32}, Int64}"><code>SpeedyWeatherEmulator.vec_to_ltm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">vec_to_ltm(vec::Vector{Float32}, trunc::Int64)</code></pre><p>Convert a spectral coefficient vector into a <code>LowerTriangularMatrix</code> representation.</p><p><strong>Description</strong></p><ul><li>Interprets the coefficient vector as complex spectral coefficients.</li><li>Places them into a triangular matrix layout consistent with SpeedyWeather.jl.</li></ul><p><strong>Arguments</strong></p><ul><li><code>vec::Vector{Float32}</code>: Vector of spectral coefficients.</li><li><code>trunc::Int64</code>: Spectral truncation of the model (e.g. 5 for T5).</li></ul><p><strong>Returns</strong></p><ul><li><code>L::LowerTriangularMatrix{ComplexF32}</code>: Complex spectral coefficient matrix.</li></ul><p><strong>Notes</strong></p><ul><li>For <code>trunc=5</code>, produces an <code>N=7 x M=6</code> <code>LowerTriangularMatrix</code> with 27 entries.</li><li><code>vec</code> is expected to be structured as [Re(c<em>1), …, Re(c</em>n<em>coeff), Im(c</em>1), …, Im(c<em>n</em>coeff)].</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">n = calc_n_coeff(trunc=5)
vec = rand(Float32, 2*n)
L = vec_to_ltm(vec, 5)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SieglStefan/SpeedyWeatherEmulator.jl/blob/09d2794a227098ad54e3c08a49fbd0fec73315f9/src/evaluation/plot_heatmap.jl#L40-L66">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../examples/">« Examples</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 5 September 2025 23:52">Friday 5 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
